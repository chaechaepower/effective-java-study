중첩 클래스란 다른 클래스 안에 정의된 클래스를 말한다. 중첩 클래스는 자신을 감싼 바깥 클래스에서만 쓰여야 하며, 그 외의 쓰임새가 있다면 톱레벨 클래스로 만들어야 한다.

### 중첩 클래스 종류

-   정적 멤버 클래스
-   비정적 멤버 클래스
-   익명 클래스
-   지역 클래스

정적 멤버 클래스를 제외한 클래스를 내부 클래스(inner class)라고 부른다.

### 정적 멤버 클래스

정적 멤버 클래스는 바깥 클래스의 private 멤버에도 접근할 수 있다는 점만 제외하고 일반클래스랑 똑같다. 정적 멤버 클래스는 다른 정적 멤버와 같은 접근 규칙을 적용한다.

```java
public class Calculator {
    public enum Operation {
        PLUS, MINUS;
    }
}
```

외부 클래스와 함께 쓰일 때만 유용한 도우미 클래스로 쓰일수 있다.

### 비정적 멤버 클래스

```java
public class Outer {
    public void fun() {

    }
    public class Inner {
        public void fun() {
            Outer.this.fun();
        }
    }
}
```

외부 클래스의 인스턴스 메서드 정규화된 this를 이용하여 호출 할 수 있다. 정규화된 클래스(`바깥클래스명.this`) 따라서 개념상 중처 클래스의 인스턴스가 바깥 인스터스와 독립적으로 존재할 수 있다면 정적 멤버 클래스로 만들어야한다. 비정적 멤버 클래스는 바깥 인스턴스 없이는 생성할 수 없기 때문이다.

비정적 멤버 클래스는 바깥 클래스의 인스턴스 메소드에서 인스턴스화 되며 그 관계가 확립이 된다.

바깥 클래스의 인스턴스.new 비정적클래스를 통해 생성하기도 하나, 이는 비용과 생성시간 측면에서 좋지 못하다.

### 익명 클래스

익명 클래스는 바깥 클래스의 멤버가 아니다.
왜냐하면 사용되는 시점에 인스턴스화 되고, 어디서든 만들 수 있기 때문이다.

또한 익명 클래스는 비정적인 문맥에서만 사용될 때 바깥 클래스의 인스턴스를 참조할 수 있다.

```java
public class AnonymousExample {
    private double x;
    private double y;


    public double operate() {
        Operator operator = new Operator() {
            @Override
            public double plus() {
                System.out.printf("%f + %f = %f\n", x, y, x + y);
                return x + y;
            }

            @Override
            public double minus() {
                System.out.printf("%f - %f = %f\n", x, y, x - y);
                return x - y;
            }
        };

        return operator.plus();
    }
}

interface Operator {
    double plus();
    double minus();
}
```

Java가 람다를 지원하기 전에는 즉석에서 작은 함수 객체나 처리 객체를 만드는 데 익명 클래스를 주로 사용했지만 이제는 람다가 그 기능을 하고 있다. 또한 표현식 중간에 등장하기 때문에 10줄이 넘어가면 가독성이 나빠진다.

### 지역 클래스

지역 클래스는 네가지 중첩 클래스 중에 가장 드물게 사용된다. 지역 클래스는 지역변수를 선언할 수 있는 곳이라면 어디서든 선언할 수 있다.
그에 따라 유효 범위도 지역변수와 같다.

다른 중첩 클래스들의 공통점을 하나씩 가지고 있는데

-   멤버 클래스처럼 이름을 가질 수 있고 반복해서 사용할 수 있다.
-   비정적 문맥에서 사용될 때만 바깥 인스턴스를 참조할 수 있다.
-   정적 멤버는 가질 수 없으며, 가독성을 위해 짧게(10줄이하)로 작성되어야 한다.

### 결론

중첩 클래스에는 네 가지가 있으며, 각각의 쓰임이 다르다. 메서드 밖에서도 사용해야 하거나 메서드 안에 정의하기엔 너무 길다면 멤버 클래스로 만든다. 멤버 클래스의 인스턴스 각각이 바깥 인스턴스를 참조한다면 비 정적으로, 그렇지 않으면 정적으로 만들자. 중첩 클래스가 한 메서드 안에서만 쓰이면서 그 인스턴스를 생성하는 지점이 단 한 곳이고 해당 타입으로 쓰기에 적합한 클래스나 인터페이스가 이미 있다면 익명 클래스로 만들고, 그렇지 않으면 지역 클래스로 만들자.
